<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cross-sample analysis • AnalyzAIRR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cross-sample analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AnalyzAIRR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorial" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorial</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorial">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/gettingstarted.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/dataloading.html">Data loading</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced data manipulation</h6></li>
    <li><a class="dropdown-item" href="../articles/datamanipulation.html">Data filtering</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Comprehensive data exploration</h6></li>
    <li><a class="dropdown-item" href="../articles/exploratory.html">Exploratory Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/onesample.html">One-sample analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>In-depth cross-sample comparison</h6></li>
    <li><a class="dropdown-item" href="../articles/datanormalization.html">Data normalization</a></li>
    <li><a class="dropdown-item" href="../articles/multisample.html">Multi-sample analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/i3-unit/AnalyzAIRR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="multisample_files/core-js-2.5.3/shim.min.js"></script><script src="multisample_files/react-18.2.0/react.min.js"></script><script src="multisample_files/react-18.2.0/react-dom.min.js"></script><script src="multisample_files/reactwidget-2.0.0/react-tools.umd.cjs"></script><link href="multisample_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="multisample_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="multisample_files/reactable-0.4.4/reactable.css" rel="stylesheet">
<script src="multisample_files/reactable-binding-0.4.4/reactable.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Cross-sample analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/i3-unit/AnalyzAIRR/blob/master/vignettes/multisample.Rmd" class="external-link"><code>vignettes/multisample.Rmd</code></a></small>
      <div class="d-none name"><code>multisample.Rmd</code></div>
    </div>

    
    
<p>The majority of the functions described in the <a href="exploratory.html">Data exploration</a> section can be applied to
compare groups of samples and perform statistical tests.</p>
<div class="section level2">
<h2 id="metadata-statistics">MetaData statistics<a class="anchor" aria-label="anchor" href="#metadata-statistics"></a>
</h2>
<p>The calculated statistics in the <strong>metaData</strong> slot can
be compared between groups of samples. This is possible using the
<code><a href="../reference/plotStatistics.html">plotStatistics()</a></code> function by setting the
<code>grouped</code> parameter to <strong>TRUE</strong> and specifying
one group column from the <strong>metadata</strong> slot to compare in
the <code>colorBy</code> parameter, and up to two columns in the
<code>facetBy</code> parameter.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotStatistics.html">plotStatistics</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RepSeqData</span>,</span>
<span>               stat <span class="op">=</span> <span class="st">"ntClone"</span>,</span>
<span>               colorBy <span class="op">=</span> <span class="st">"cell_subset"</span>, </span>
<span>               facetBy <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>               grouped <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<img src="multisample_files/figure-html/comp%20sd1-1.png" width="700" style="display: block; margin: auto;"><figcaption align="center"><em class="special">Figure 1: Comparison of the the number of ntClones
between amTreg and nTreg samples. Boxplots represent the median across
all samples belonging to the same group.</em>
</figcaption><p><br></p>
<div class="section level3">
<h3 id="gene-usage">Gene usage<a class="anchor" aria-label="anchor" href="#gene-usage"></a>
</h3>
<p><code><a href="../reference/plotGeneUsage.html">plotGeneUsage()</a></code> allows the comparison of V or J gene
usages between groups of samples using the <code>colorBy</code>
parameter.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotGeneUsage.html">plotGeneUsage</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RepSeqData</span>, </span>
<span>              level <span class="op">=</span> <span class="st">"J"</span>, </span>
<span>              scale <span class="op">=</span> <span class="st">"frequency"</span>, </span>
<span>              colorBy <span class="op">=</span> <span class="st">"cell_subset"</span>,</span>
<span>              show_stats <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<img src="multisample_files/figure-html/J%20usage%20-1.png" width="1152" style="display: block; margin: auto;"><figcaption align="center"><em class="special">Figure 2: Comparison of the J gene usage between
amTreg and nTreg samples. A Wilcoxon test was performed. Only
significant values are plotted.</em>
</figcaption><p><br></p>
</div>
<div class="section level3">
<h3 id="repertoire-diversity">Repertoire diversity<a class="anchor" aria-label="anchor" href="#repertoire-diversity"></a>
</h3>
<p>Diversity indices can be compared between groups of samples using the
<code><a href="../reference/plotDiversity.html">plotDiversity()</a></code> function with the <code>grouped</code>
parameter set to <strong>TRUE</strong>, and the groups to be analysed
should be specified in the <code>colorBy</code> parameter.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotDiversity.html">plotDiversity</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RepSeqData</span>,</span>
<span>              level <span class="op">=</span> <span class="st">"aaClone"</span>,</span>
<span>              index <span class="op">=</span> <span class="st">"shannon"</span>,</span>
<span>              colorBy <span class="op">=</span> <span class="st">"cell_subset"</span>,</span>
<span>              grouped <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              show_stats <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<img src="multisample_files/figure-html/plot%20indices%203-1.png" width="700" style="display: block; margin: auto;"><figcaption align="center"><em class="special">Figure 3: The Shannon index is calculated at the
aaClone level and compared between cell subsets. Boxplots represent the
median across all samples belonging to the same group. A Wilcoxon test
is applied and adjusted p-values using the Holm method are shown.</em>
</figcaption><p><br></p>
<p>The Renyi index also supports the <code>grouped</code> parameter.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotRenyiIndex.html">plotRenyiIndex</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RepSeqData</span>,</span>
<span>               level <span class="op">=</span> <span class="st">"aaClone"</span>,</span>
<span>               colorBy <span class="op">=</span> <span class="st">"cell_subset"</span>,</span>
<span>               grouped <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<img src="multisample_files/figure-html/plot%20plotRenyiIndexG-1.png" width="672" style="display: block; margin: auto;"><figcaption align="center"><em class="special">Figure 4: The Renyi values were calculated at the
aaClone level at each pre-defined alpha value. For each specified group,
the mean (circles) and stantard error (shade) are plotted.</em>
</figcaption>
</div>
<div class="section level3">
<h3 id="clonal-distribution">Clonal distribution<a class="anchor" aria-label="anchor" href="#clonal-distribution"></a>
</h3>
<p>Similarly to the analysis applied at the single-sample level,
<code><a href="../reference/plotIntervals.html">plotIntervals()</a></code> allows to plot and compare clonal
distributions within defined count intervals between experimental
groups.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotIntervals.html">plotIntervals</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RepSeqData</span>, </span>
<span>              level <span class="op">=</span> <span class="st">"aaClone"</span>, </span>
<span>              colorBy <span class="op">=</span> <span class="st">"cell_subset"</span>, </span>
<span>              fractions <span class="op">=</span> <span class="st">"count"</span>, </span>
<span>              grouped <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              show_stats <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<img src="multisample_files/figure-html/plotDistribVpJall-1.png" width="816" style="display: block; margin: auto;"><figcaption align="center"><em class="special">Figure 5: The distribution (upper plot) and the
cumulative frequency (bottom plot) of aaClones within each count
interval was compared between amTreg and nTreg samples within each sex.
A Wilcoxon test is applied and adjusted p-values using the Holm method
are shown.</em>
</figcaption>
</div>
</div>
<div class="section level2">
<h2 id="similarity-analysis">Similarity analysis<a class="anchor" aria-label="anchor" href="#similarity-analysis"></a>
</h2>
<p>The repertoire sharing at any level evaluates the degree of
convergence between repertoires and experimental conditions. Different
statistical methods are proposed herein to evaluate this
convergence.</p>
<div class="section level3">
<h3 id="repertoire-overlap">Repertoire overlap<a class="anchor" aria-label="anchor" href="#repertoire-overlap"></a>
</h3>
<p>The number of shared sequences, at any level, between samples
belonging for instance to the same experimental group can be obtained
using the <code><a href="../reference/plotVenn.html">plotVenn()</a></code> function. If <code>sampleNames</code>
is not specified, the first 3 samples in the datasets will be
analyzed.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ctrnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="../reference/RepSeqExperiment-class.html">mData</a></span><span class="op">(</span><span class="va">RepSeqData</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="../reference/RepSeqExperiment-class.html">mData</a></span><span class="op">(</span><span class="va">RepSeqData</span><span class="op">)</span><span class="op">[</span>,<span class="st">"cell_subset"</span> <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"nTreg"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/plotVenn.html">plotVenn</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RepSeqData</span>,</span>
<span>         level <span class="op">=</span> <span class="st">"aaClone"</span>,</span>
<span>         sampleNames <span class="op">=</span> <span class="va">ctrnames</span><span class="op">)</span></span></code></pre></div>
<img src="multisample_files/figure-html/venn-1.png" width="768" style="display: block; margin: auto;"><figcaption align="center"><em class="special">Figure 6: Venn diagram representing the number of
shared aaClones between the nTreg samples.</em>
</figcaption><p><br></p>
</div>
<div class="section level3">
<h3 id="correlation-between-a-pair-of-samples">Correlation between a pair of samples<a class="anchor" aria-label="anchor" href="#correlation-between-a-pair-of-samples"></a>
</h3>
<p>The correlation between a pair of repertoires can be calculated using
the <code><a href="../reference/plotScatter.html">plotScatter()</a></code> function by simply specifying a two or
more <code>sampleNames</code> to compare.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotScatter.html">plotScatter</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RepSeqData</span>,</span>
<span>            level <span class="op">=</span> <span class="st">"V"</span>,</span>
<span>            scale <span class="op">=</span> <span class="st">"frequency"</span>,</span>
<span>            sampleNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tripod-30-813"</span>,<span class="st">"tripod-31-846"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="multisample_files/figure-html/scatter-1.png" width="700" style="display: block; margin: auto;"><figcaption align="center"><em class="special">Figure 7: A biplot comparing the V gene usage
between two defined samples. A linear model is fitted on the data. The V
usage is significantly similar between the two samples.</em>
</figcaption><p><br></p>
<p>It is also possible to compare, for instance, all samples beloging to
a specific group. In the example below, scatter plots and drawn between
all pairwise nTreg samples.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">names</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">RepSeqData</span><span class="op">@</span><span class="va">metaData</span><span class="op">$</span><span class="va">sample_id</span><span class="op">[</span><span class="va">RepSeqData</span><span class="op">@</span><span class="va">metaData</span><span class="op">$</span><span class="va">cell_subset</span><span class="op">==</span><span class="st">"nTreg"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotScatter.html">plotScatter</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RepSeqData</span>,</span>
<span>            level <span class="op">=</span> <span class="st">"VJ"</span>,</span>
<span>            scale <span class="op">=</span> <span class="st">"frequency"</span>,</span>
<span>            sampleNames <span class="op">=</span> <span class="va">names</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="multisample_files/figure-html/scatter%202-1.png" width="768" style="display: block; margin: auto;"><figcaption align="center"><em class="special">Figure 8: A biplot comparing the clonal expression
between two defined samples. A linear model is fitted on the data.
Clonal overlap and expression are significantly low between the compared
samples.</em>
</figcaption><p><br></p>
</div>
<div class="section level3">
<h3 id="dissimilarity-indices">Dissimilarity indices<a class="anchor" aria-label="anchor" href="#dissimilarity-indices"></a>
</h3>
<p><strong>AnalyzAIRR</strong> proposes a list of dissimilarity indices,
each taking into account different parameters. The proposed methods
include:</p>
<ul>
<li><p>The <strong>Jaccard</strong> similarity: a measure of similarity
between sample sets defined as the size of the intersection divided by
the size of the union of the sample sets.</p></li>
<li><p>The <strong>Morisita-Horn</strong> similarity: a measure of
similarity that tends to be over-sensitive to abundant species.</p></li>
</ul>
<p>Details on these indices and others can be found <a href="https://rdrr.io/cran/vegan/man/vegdist.html" class="external-link">here</a></p>
<p>These distances can be calculated at any level of the repertoire and
can be:</p>
<ul>
<li>Visualized As a dissimilarity heatmap by setting <code>plot</code>
to <strong>Heatmap</strong>. This function performs a hierarchical
clustering on the calculated distance scores using the method specified
in the <code>clustering</code> parameter.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotDissimilarity.html">plotDissimilarity</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RepSeqData</span>,</span>
<span>                  level <span class="op">=</span> <span class="st">"aaClone"</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"morisita"</span>,</span>
<span>                  clustering <span class="op">=</span> <span class="st">"ward.D"</span>,</span>
<span>                  colorBy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>,<span class="st">"cell_subset"</span><span class="op">)</span>,</span>
<span>                  plot <span class="op">=</span> <span class="st">"Heatmap"</span><span class="op">)</span></span></code></pre></div>
<img src="multisample_files/figure-html/dissimilarity-1.png" width="700" style="display: block; margin: auto;"><figcaption align="center"><em class="special">Figure 9: A heatmap showing the Morisita distances
calculated at the aaClone level between all pairwise samples. The ward D
method was used to perform the hierarchical clustering.</em>
</figcaption><p><br></p>
<ul>
<li>Used to perform a multidimensional scaling analysis by setting
<code>plot</code> to <strong>MDS</strong>. In this case, no clustering
method is needed.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotDissimilarity.html">plotDissimilarity</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RepSeqData</span>,</span>
<span>                 level <span class="op">=</span> <span class="st">"aaClone"</span>,</span>
<span>                 method <span class="op">=</span> <span class="st">"morisita"</span>,</span>
<span>                 colorBy <span class="op">=</span> <span class="st">"cell_subset"</span>,</span>
<span>                 plot <span class="op">=</span> <span class="st">"MDS"</span><span class="op">)</span></span></code></pre></div>
<img src="multisample_files/figure-html/mds1-1.png" width="700" style="display: block; margin: auto;"><figcaption align="center"><em class="special">Figure 25: Morisita distances were calculated at the
aaClone level between all pairwise samples within the dataset and used
to perform a multidimensional scaling analysis.</em>
</figcaption><p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="differential-analysis">Differential analysis<a class="anchor" aria-label="anchor" href="#differential-analysis"></a>
</h2>
<p>Differentially expressed genes or sequences can be identified using
<code>diffExpGroup</code>. The experimental groups to be compared can be
specified with the <code>group</code> parameter, and the function
outputs the statistics calculated for each gene/sequence.</p>
<p>In the following example, we identify over-expressed VJ combinations
within the amTreg samples compared to the nTregs.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diffExpGroup.html">diffExpGroup</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RepSeqData</span>,</span>
<span>                   colGrp <span class="op">=</span> <span class="st">"cell_subset"</span> ,</span>
<span>                   level <span class="op">=</span> <span class="st">"VJ"</span>,</span>
<span>                   group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cell_subset"</span>, <span class="st">"amTreg"</span>, <span class="st">"nTreg"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="reactable html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".rownames":["TRAV7-6 TRAJ33","TRAV6-4 TRAJ40","TRAV5-4 TRAJ31","TRAV12-2 TRAJ37","TRAV14N-3 TRAJ12","TRAV7-6 TRAJ47"],"baseMean":[711.09,301.65,1952.56,997.96,1308.14,238.43],"log2FoldChange":[2.55,2.75,2.47,1.48,1.58,2.77],"lfcSE":[0.27,0.35,0.33,0.22,0.27,0.48],"stat":[9.55,7.84,7.51,6.9,5.77,5.76],"pvalue":[0,0,0,0,0,0],"padj":[0,0,0,0,0,0]},"columns":[{"id":".rownames","name":"","type":"character","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"},"sortable":false,"filterable":false,"rowHeader":true},{"id":"baseMean","name":"baseMean","type":"numeric","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"}},{"id":"log2FoldChange","name":"log2FoldChange","type":"numeric","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"}},{"id":"lfcSE","name":"lfcSE","type":"numeric","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"}},{"id":"stat","name":"stat","type":"numeric","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"}},{"id":"pvalue","name":"pvalue","type":"numeric","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"}},{"id":"padj","name":"padj","type":"numeric","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"}}],"bordered":true,"dataKey":"d9b7872caa305655989f389652b1c885"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script><p><br></p>
<p>The results can be visualized using the <code>plotDiffExp</code>
function into a volcano plot.</p>
<p>Users can specify the number of top differentially expressed
genes/sequences to be identified on the plot using the <code>top</code>
parameter. It is also possible to choose a log2FoldChange and an
adjusted pvalue threshold, based on which the over- and down-expression
will be defined. By default, these parameters are fixed to 2 and 0.05
respectively.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotDiffExp.html">plotDiffExp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RepSeqData</span>,</span>
<span>            top <span class="op">=</span> <span class="fl">10</span>,</span>
<span>            level <span class="op">=</span> <span class="st">"VJ"</span>,</span>
<span>            group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cell_subset"</span>, <span class="st">"amTreg"</span>, <span class="st">"nTreg"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="multisample_files/figure-html/volcano-1.png" width="672" style="display: block; margin: auto;"><figcaption align="center"><em class="special">Figure 26: A volcano plot showing differentially
expressed VJ combinations between amTreg and nTreg samples.
Over-expressed combinations in the amTreg population are shown in
red.</em>
</figcaption><p><br></p>
</div>
<div class="section level2">
<h2 id="spectratyping-comparison">Spectratyping comparison<a class="anchor" aria-label="anchor" href="#spectratyping-comparison"></a>
</h2>
<p>The <code><a href="../reference/perturbationScore.html">perturbationScore()</a></code> function computes the
perturbation scores of the aaCDR3 length distribution within each V gene
as a distance between each repertoire and the mean repertoire of the
control group.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ctrnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="../reference/RepSeqExperiment-class.html">mData</a></span><span class="op">(</span><span class="va">RepSeqData</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="../reference/RepSeqExperiment-class.html">mData</a></span><span class="op">(</span><span class="va">RepSeqData</span><span class="op">)</span><span class="op">[</span>,<span class="st">"cell_subset"</span> <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"nTreg"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/perturbationScore.html">perturbationScore</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RepSeqData</span>, </span>
<span>                  ctrl.names <span class="op">=</span> <span class="va">ctrnames</span>, </span>
<span>                  distance <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span></span></code></pre></div>
<div class="reactable html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"tag":{"name":"Reactable","attribs":{"data":{".rownames":["TRAV1","TRAV10","TRAV10D","TRAV10N","TRAV11","TRAV11N"],"tripod-30-813":[0.1,0.03,0.08,0.16,0.14,0.4],"tripod-30-815":[0.02,0.03,0.03,0.04,0.03,0.08],"tripod-31-846":[0.12,0.07,0.06,0.12,0.11,0.23],"tripod-31-848":[0.02,0.03,0.05,0.02,0.03,0.14],"tripod-35-970":[0.12,0.15,0.23,0.15,0.14,0.27],"tripod-35-972":[0.03,0.02,0.1,0.07,0.03,0.19],"tripod-36-1003":[0.04,0.03,0.11,0.1,0.04,0.18],"tripod-36-1005":[0.2,0.05,0.06,0.15,0.1,0.23]},"columns":[{"id":".rownames","name":"","type":"character","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"},"sortable":false,"filterable":false,"rowHeader":true},{"id":"tripod-30-813","name":"tripod-30-813","type":"numeric","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"}},{"id":"tripod-30-815","name":"tripod-30-815","type":"numeric","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"}},{"id":"tripod-31-846","name":"tripod-31-846","type":"numeric","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"}},{"id":"tripod-31-848","name":"tripod-31-848","type":"numeric","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"}},{"id":"tripod-35-970","name":"tripod-35-970","type":"numeric","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"}},{"id":"tripod-35-972","name":"tripod-35-972","type":"numeric","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"}},{"id":"tripod-36-1003","name":"tripod-36-1003","type":"numeric","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"}},{"id":"tripod-36-1005","name":"tripod-36-1005","type":"numeric","minWidth":150,"align":"center","vAlign":"center","headerStyle":{"background":"#f7f7f8"}}],"bordered":true,"dataKey":"8d66aa2c8a7e5b0461dbc86631015917"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script><p><br> Scores can be visualized in a heatmap using the
<code><a href="../reference/plotPerturbationScore.html">plotPerturbationScore()</a></code> function.</p>
<p>The parameter <code>order</code> allows to define the order in which
the samples will be plotted on the heatmap which helps a better
separation between the control groups and the other samples.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPerturbationScore.html">plotPerturbationScore</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">RepSeqData</span>, </span>
<span>                      ctrl.names <span class="op">=</span> <span class="va">ctrnames</span>, </span>
<span>                      distance <span class="op">=</span> <span class="st">"euclidean"</span>, </span>
<span>                      order <span class="op">=</span> <span class="st">"cell_subset"</span><span class="op">)</span></span></code></pre></div>
<img src="multisample_files/figure-html/unnamed-chunk-3-1.png" width="768" style="display: block; margin: auto;"><figcaption align="center"><em class="special">Figure 28: A heatmap plotting the perturbation
scores of the aaCDR3 length distribution within each V gene in the
amTreg population compared to the nTregs (used as reference). The
parameter order allows to define the order in which the samples will be
plotted on the heatmap which helps a better separation between the
control groups and the other samples.</em>
</figcaption>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vanessa Mhanna, Gabriel Pires, Grégoire Bohl, Karim El Soufi, Nicolas Tchitchek, David Klatzmann, Adrien Six, Hang-Phuong Pham, Encarnita Mariotti-Ferrandiz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
