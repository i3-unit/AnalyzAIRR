<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Adaptive immune repertoire filtering — filterClones • AnalyzAIRR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Adaptive immune repertoire filtering — filterClones"><meta name="description" content="This function filters adaptive immune repertoires that were not aligned by a AnalyzAIRR-supported tool. The loaded clonotype table must however contain the required columns:
- sample_id: sample names
- V: Variable gene name
- J: Joining gene name
- aaCDR3: amino acid CDR3 sequence
- ntCDR3: nucleotide CDR3 sequence
- aaClone: Full clone sequence including the V gene, the amino acid CDR3 sequence and the J gene
- VJ: V-J gene combination using V and J gene names
- ntClone: Full clone sequence including the V gene, the nucleotide CDR3 sequence and the J gene
- count: the occurrence of the clone
and applies at least one of the following filters:
- filter out ambiguous clones
- filter out unproductive sequences including out-of-frame sequences with stop codons
- filter out singletons, i.e clones with an occurrence of 1"><meta property="og:description" content="This function filters adaptive immune repertoires that were not aligned by a AnalyzAIRR-supported tool. The loaded clonotype table must however contain the required columns:
- sample_id: sample names
- V: Variable gene name
- J: Joining gene name
- aaCDR3: amino acid CDR3 sequence
- ntCDR3: nucleotide CDR3 sequence
- aaClone: Full clone sequence including the V gene, the amino acid CDR3 sequence and the J gene
- VJ: V-J gene combination using V and J gene names
- ntClone: Full clone sequence including the V gene, the nucleotide CDR3 sequence and the J gene
- count: the occurrence of the clone
and applies at least one of the following filters:
- filter out ambiguous clones
- filter out unproductive sequences including out-of-frame sequences with stop codons
- filter out singletons, i.e clones with an occurrence of 1"><meta property="og:image" content="https://i3-unit.github.io/AnalyzAIRR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AnalyzAIRR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorial" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorial</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorial"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/gettingstarted.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/dataloading.html">Data loading</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Comprehensive data exploration</h6></li>
    <li><a class="dropdown-item" href="../articles/exploratory.html">Exploratory analysis</a></li>
    <li><a class="dropdown-item" href="../articles/onesample.html">One-sample analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced data manipulation</h6></li>
    <li><a class="dropdown-item" href="../articles/datamanipulation.html">Data filtering</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>In-depth cross-sample comparison</h6></li>
    <li><a class="dropdown-item" href="../articles/datanormalization.html">Data normalization</a></li>
    <li><a class="dropdown-item" href="../articles/multisample.html">Multi-sample analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Interactive AIRR data analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/shiny.html">Shiny-AnalyzAIRR</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/i3-unit/AnalyzAIRR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Adaptive immune repertoire filtering</h1>
      <small class="dont-index">Source: <a href="https://github.com/i3-unit/AnalyzAIRR/blob/HEAD/R/loadData.R" class="external-link"><code>R/loadData.R</code></a></small>
      <div class="d-none name"><code>filterClones.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function filters adaptive immune repertoires that were not aligned by a AnalyzAIRR-supported tool. The loaded clonotype table must however contain the required columns:</p>
<p>- sample_id: sample names</p>
<p>- V: Variable gene name</p>
<p>- J: Joining gene name</p>
<p>- aaCDR3: amino acid CDR3 sequence</p>
<p>- ntCDR3: nucleotide CDR3 sequence</p>
<p>- aaClone: Full clone sequence including the V gene, the amino acid CDR3 sequence and the J gene</p>
<p>- VJ: V-J gene combination using V and J gene names</p>
<p>- ntClone: Full clone sequence including the V gene, the nucleotide CDR3 sequence and the J gene</p>
<p>- count: the occurrence of the clone</p>
<p>and applies at least one of the following filters:</p>
<p>- filter out ambiguous clones</p>
<p>- filter out unproductive sequences including out-of-frame sequences with stop codons</p>
<p>- filter out singletons, i.e clones with an occurrence of 1</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">filterClones</span><span class="op">(</span></span>
<span>  <span class="va">raw</span>,</span>
<span>  keep.ambiguous <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keep.unproductive <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  aa.th <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outFiltered <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-raw">raw<a class="anchor" aria-label="anchor" href="#arg-raw"></a></dt>
<dd><p>a single clonotype table containing the previously cited required columns</p></dd>


<dt id="arg-keep-ambiguous">keep.ambiguous<a class="anchor" aria-label="anchor" href="#arg-keep-ambiguous"></a></dt>
<dd><p>a boolean, whether ambiguous sequences containing an "N" in the CDR3 nucleotide should be left in. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-keep-unproductive">keep.unproductive<a class="anchor" aria-label="anchor" href="#arg-keep-unproductive"></a></dt>
<dd><p>a boolean, whether unproductive sequences should be left in. Default is <code>FALSE</code>.
Unproductive sequences include:</p>
<p>- out-of-frame sequences: sequences with frame shifts based on the number of nucleotides in the ntCDR3 column</p>
<p>- sequences containing stop codons: aaCDR3 sequences with a "*" or "~" symbols.should be kept. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-aa-th">aa.th<a class="anchor" aria-label="anchor" href="#arg-aa-th"></a></dt>
<dd><p>an interger, indicates the maximum number of amino acids deviating from the mean length to tolerate. Default is 8. In this case, all amino acid CDR3s sequences with length falling outside the range of mean+- 8 are filtered out.</p></dd>


<dt id="arg-outfiltered">outFiltered<a class="anchor" aria-label="anchor" href="#arg-outfiltered"></a></dt>
<dd><p>write in the directory path a data frame containing the filtered out reads. Default path is getwd().</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a filtered clonotype table.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">'extdata/MiAIRR'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     package <span class="op">=</span> <span class="st">'AnalyzAIRR'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="va">l</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">miairr_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="parseAIRRC.html">parseAIRRC</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">path</span>, chain <span class="op">=</span> <span class="st">"TRA"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">filterClones</span><span class="op">(</span><span class="va">miairr_table</span>,</span></span>
<span class="r-in"><span>                        keep.ambiguous <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                        keep.unproductive <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                        aa.th <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>                        outFiltered <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vanessa Mhanna, Gabriel Pires, Grégoire Bohl, Karim El Soufi, Nicolas Tchitchek, David Klatzmann, Adrien Six, Hang-Phuong Pham, Encarnita Mariotti-Ferrandiz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

